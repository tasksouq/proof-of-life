"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0";
exports.ids = ["vendor-chunks/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/chunk-HZ2SQA5V.js":
/*!****************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/chunk-HZ2SQA5V.js ***!
  \****************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   encodeAction: () => (/* binding */ encodeAction),\n/* harmony export */   generateSignal: () => (/* binding */ generateSignal),\n/* harmony export */   hashToField: () => (/* binding */ hashToField),\n/* harmony export */   packAndEncode: () => (/* binding */ packAndEncode),\n/* harmony export */   solidityEncode: () => (/* binding */ solidityEncode)\n/* harmony export */ });\n/* harmony import */ var buffer_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! buffer/index.js */ \"(ssr)/./node_modules/.pnpm/buffer@6.0.3/node_modules/buffer/index.js\");\n/* harmony import */ var ox__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ox */ \"(ssr)/./node_modules/.pnpm/ox@0.1.8_typescript@5.9.3/node_modules/ox/_esm/core/Bytes.js\");\n/* harmony import */ var ox__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ox */ \"(ssr)/./node_modules/.pnpm/ox@0.1.8_typescript@5.9.3/node_modules/ox/_esm/core/Hex.js\");\n/* harmony import */ var ox__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ox */ \"(ssr)/./node_modules/.pnpm/ox@0.1.8_typescript@5.9.3/node_modules/ox/_esm/core/AbiParameters.js\");\n/* harmony import */ var ox__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ox */ \"(ssr)/./node_modules/.pnpm/ox@0.1.8_typescript@5.9.3/node_modules/ox/_esm/core/Hash.js\");\n// src/lib/hashing.ts\n\n\nfunction hashToField(input) {\n  if (ox__WEBPACK_IMPORTED_MODULE_1__.validate(input) || ox__WEBPACK_IMPORTED_MODULE_2__.validate(input)) return hashEncodedBytes(input);\n  return hashString(input);\n}\nfunction packAndEncode(input) {\n  const [types, values] = input.reduce(\n    ([types2, values2], [type, value]) => {\n      types2.push(type);\n      values2.push(value);\n      return [types2, values2];\n    },\n    [[], []]\n  );\n  return hashEncodedBytes(ox__WEBPACK_IMPORTED_MODULE_3__.encodePacked(types, values));\n}\nfunction hashString(input) {\n  const bytesInput = buffer_index_js__WEBPACK_IMPORTED_MODULE_0__.Buffer.from(input);\n  return hashEncodedBytes(bytesInput);\n}\nfunction hashEncodedBytes(input) {\n  const hash = BigInt(ox__WEBPACK_IMPORTED_MODULE_4__.keccak256(input, { as: \"Hex\" })) >> 8n;\n  const rawDigest = hash.toString(16);\n  return { hash, digest: `0x${rawDigest.padStart(64, \"0\")}` };\n}\nvar solidityEncode = (types, values) => {\n  if (types.length !== values.length) {\n    throw new Error(\"Types and values arrays must have the same length.\");\n  }\n  return { types, values };\n};\nvar generateSignal = (signal) => {\n  if (!signal || typeof signal === \"string\") return hashToField(signal ?? \"\");\n  return packAndEncode(signal.types.map((type, index) => [type, signal.values[index]]));\n};\nvar encodeAction = (action) => {\n  if (!action) return \"\";\n  if (typeof action === \"string\") return action;\n  return action.types.map((type, index) => `${type}(${action.values[index]})`).join(\",\");\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHdvcmxkY29pbitpZGtpdC1jb3JlQDIuMS4wXzU4YzBkYzc4YTI0NmVmNGQyYzM4OTcxMTA4YzE3ZGUwL25vZGVfbW9kdWxlcy9Ad29ybGRjb2luL2lka2l0LWNvcmUvYnVpbGQvY2h1bmstSFoyU1FBNVYuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ3lDO0FBQ1k7QUFDckQ7QUFDQSxNQUFNLHdDQUFjLFdBQVcsd0NBQVk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsMEJBQTBCLDRDQUEwQjtBQUNwRDtBQUNBO0FBQ0EscUJBQXFCLG1EQUFNO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix5Q0FBYyxVQUFVLFdBQVc7QUFDekQ7QUFDQSxXQUFXLG1CQUFtQiw0QkFBNEI7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLEtBQUssR0FBRyxxQkFBcUI7QUFDM0U7O0FBUUUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWRtaW4uTU9IQU1NRUQtUENcXERvY3VtZW50c1xcbGlmZVxcTWluaUFwcFdlYjN0ZW1wbGF0ZVxcbXktYXBwXFxub2RlX21vZHVsZXNcXC5wbnBtXFxAd29ybGRjb2luK2lka2l0LWNvcmVAMi4xLjBfNThjMGRjNzhhMjQ2ZWY0ZDJjMzg5NzExMDhjMTdkZTBcXG5vZGVfbW9kdWxlc1xcQHdvcmxkY29pblxcaWRraXQtY29yZVxcYnVpbGRcXGNodW5rLUhaMlNRQTVWLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9saWIvaGFzaGluZy50c1xuaW1wb3J0IHsgQnVmZmVyIH0gZnJvbSBcImJ1ZmZlci9pbmRleC5qc1wiO1xuaW1wb3J0IHsgQWJpUGFyYW1ldGVycywgQnl0ZXMsIEhleCwgSGFzaCB9IGZyb20gXCJveFwiO1xuZnVuY3Rpb24gaGFzaFRvRmllbGQoaW5wdXQpIHtcbiAgaWYgKEJ5dGVzLnZhbGlkYXRlKGlucHV0KSB8fCBIZXgudmFsaWRhdGUoaW5wdXQpKSByZXR1cm4gaGFzaEVuY29kZWRCeXRlcyhpbnB1dCk7XG4gIHJldHVybiBoYXNoU3RyaW5nKGlucHV0KTtcbn1cbmZ1bmN0aW9uIHBhY2tBbmRFbmNvZGUoaW5wdXQpIHtcbiAgY29uc3QgW3R5cGVzLCB2YWx1ZXNdID0gaW5wdXQucmVkdWNlKFxuICAgIChbdHlwZXMyLCB2YWx1ZXMyXSwgW3R5cGUsIHZhbHVlXSkgPT4ge1xuICAgICAgdHlwZXMyLnB1c2godHlwZSk7XG4gICAgICB2YWx1ZXMyLnB1c2godmFsdWUpO1xuICAgICAgcmV0dXJuIFt0eXBlczIsIHZhbHVlczJdO1xuICAgIH0sXG4gICAgW1tdLCBbXV1cbiAgKTtcbiAgcmV0dXJuIGhhc2hFbmNvZGVkQnl0ZXMoQWJpUGFyYW1ldGVycy5lbmNvZGVQYWNrZWQodHlwZXMsIHZhbHVlcykpO1xufVxuZnVuY3Rpb24gaGFzaFN0cmluZyhpbnB1dCkge1xuICBjb25zdCBieXRlc0lucHV0ID0gQnVmZmVyLmZyb20oaW5wdXQpO1xuICByZXR1cm4gaGFzaEVuY29kZWRCeXRlcyhieXRlc0lucHV0KTtcbn1cbmZ1bmN0aW9uIGhhc2hFbmNvZGVkQnl0ZXMoaW5wdXQpIHtcbiAgY29uc3QgaGFzaCA9IEJpZ0ludChIYXNoLmtlY2NhazI1NihpbnB1dCwgeyBhczogXCJIZXhcIiB9KSkgPj4gOG47XG4gIGNvbnN0IHJhd0RpZ2VzdCA9IGhhc2gudG9TdHJpbmcoMTYpO1xuICByZXR1cm4geyBoYXNoLCBkaWdlc3Q6IGAweCR7cmF3RGlnZXN0LnBhZFN0YXJ0KDY0LCBcIjBcIil9YCB9O1xufVxudmFyIHNvbGlkaXR5RW5jb2RlID0gKHR5cGVzLCB2YWx1ZXMpID0+IHtcbiAgaWYgKHR5cGVzLmxlbmd0aCAhPT0gdmFsdWVzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlR5cGVzIGFuZCB2YWx1ZXMgYXJyYXlzIG11c3QgaGF2ZSB0aGUgc2FtZSBsZW5ndGguXCIpO1xuICB9XG4gIHJldHVybiB7IHR5cGVzLCB2YWx1ZXMgfTtcbn07XG52YXIgZ2VuZXJhdGVTaWduYWwgPSAoc2lnbmFsKSA9PiB7XG4gIGlmICghc2lnbmFsIHx8IHR5cGVvZiBzaWduYWwgPT09IFwic3RyaW5nXCIpIHJldHVybiBoYXNoVG9GaWVsZChzaWduYWwgPz8gXCJcIik7XG4gIHJldHVybiBwYWNrQW5kRW5jb2RlKHNpZ25hbC50eXBlcy5tYXAoKHR5cGUsIGluZGV4KSA9PiBbdHlwZSwgc2lnbmFsLnZhbHVlc1tpbmRleF1dKSk7XG59O1xudmFyIGVuY29kZUFjdGlvbiA9IChhY3Rpb24pID0+IHtcbiAgaWYgKCFhY3Rpb24pIHJldHVybiBcIlwiO1xuICBpZiAodHlwZW9mIGFjdGlvbiA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIGFjdGlvbjtcbiAgcmV0dXJuIGFjdGlvbi50eXBlcy5tYXAoKHR5cGUsIGluZGV4KSA9PiBgJHt0eXBlfSgke2FjdGlvbi52YWx1ZXNbaW5kZXhdfSlgKS5qb2luKFwiLFwiKTtcbn07XG5cbmV4cG9ydCB7XG4gIGhhc2hUb0ZpZWxkLFxuICBwYWNrQW5kRW5jb2RlLFxuICBzb2xpZGl0eUVuY29kZSxcbiAgZ2VuZXJhdGVTaWduYWwsXG4gIGVuY29kZUFjdGlvblxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/chunk-HZ2SQA5V.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/index.js":
/*!*******************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/index.js ***!
  \*******************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppErrorCodes: () => (/* binding */ AppErrorCodes),\n/* harmony export */   CredentialType: () => (/* binding */ CredentialType),\n/* harmony export */   DEFAULT_VERIFICATION_LEVEL: () => (/* binding */ DEFAULT_VERIFICATION_LEVEL),\n/* harmony export */   VerificationLevel: () => (/* binding */ VerificationLevel),\n/* harmony export */   VerificationState: () => (/* binding */ VerificationState),\n/* harmony export */   createWorldBridgeStore: () => (/* binding */ createWorldBridgeStore),\n/* harmony export */   useWorldBridgeStore: () => (/* binding */ useWorldBridgeStore),\n/* harmony export */   verification_level_to_credential_types: () => (/* binding */ verification_level_to_credential_types)\n/* harmony export */ });\n/* harmony import */ var _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-HZ2SQA5V.js */ \"(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/chunk-HZ2SQA5V.js\");\n/* harmony import */ var zustand__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zustand */ \"(ssr)/./node_modules/.pnpm/zustand@4.5.7_@types+react@19.2.2_immer@10.0.2_react@19.2.0/node_modules/zustand/esm/index.mjs\");\n/* harmony import */ var browser_or_node__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! browser-or-node */ \"(ssr)/./node_modules/.pnpm/browser-or-node@3.0.0-pre.0/node_modules/browser-or-node/dist/index.mjs\");\n/* harmony import */ var buffer_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! buffer/index.js */ \"(ssr)/./node_modules/.pnpm/buffer@6.0.3/node_modules/buffer/index.js\");\n\n\n// src/types/bridge.ts\nvar AppErrorCodes = /* @__PURE__ */ ((AppErrorCodes2) => {\n  AppErrorCodes2[\"ConnectionFailed\"] = \"connection_failed\";\n  AppErrorCodes2[\"VerificationRejected\"] = \"verification_rejected\";\n  AppErrorCodes2[\"MaxVerificationsReached\"] = \"max_verifications_reached\";\n  AppErrorCodes2[\"CredentialUnavailable\"] = \"credential_unavailable\";\n  AppErrorCodes2[\"MalformedRequest\"] = \"malformed_request\";\n  AppErrorCodes2[\"InvalidNetwork\"] = \"invalid_network\";\n  AppErrorCodes2[\"InclusionProofFailed\"] = \"inclusion_proof_failed\";\n  AppErrorCodes2[\"InclusionProofPending\"] = \"inclusion_proof_pending\";\n  AppErrorCodes2[\"UnexpectedResponse\"] = \"unexpected_response\";\n  AppErrorCodes2[\"FailedByHostApp\"] = \"failed_by_host_app\";\n  AppErrorCodes2[\"GenericError\"] = \"generic_error\";\n  return AppErrorCodes2;\n})(AppErrorCodes || {});\nvar VerificationState = /* @__PURE__ */ ((VerificationState2) => {\n  VerificationState2[\"PreparingClient\"] = \"loading_widget\";\n  VerificationState2[\"WaitingForConnection\"] = \"awaiting_connection\";\n  VerificationState2[\"WaitingForApp\"] = \"awaiting_app\";\n  VerificationState2[\"Confirmed\"] = \"confirmed\";\n  VerificationState2[\"Failed\"] = \"failed\";\n  return VerificationState2;\n})(VerificationState || {});\n\n// src/types/config.ts\nvar CredentialType = /* @__PURE__ */ ((CredentialType2) => {\n  CredentialType2[\"Orb\"] = \"orb\";\n  CredentialType2[\"SecureDocument\"] = \"secure_document\";\n  CredentialType2[\"Document\"] = \"document\";\n  CredentialType2[\"Device\"] = \"device\";\n  return CredentialType2;\n})(CredentialType || {});\nvar VerificationLevel = /* @__PURE__ */ ((VerificationLevel2) => {\n  VerificationLevel2[\"Orb\"] = \"orb\";\n  VerificationLevel2[\"SecureDocument\"] = \"secure_document\";\n  VerificationLevel2[\"Document\"] = \"document\";\n  VerificationLevel2[\"Device\"] = \"device\";\n  return VerificationLevel2;\n})(VerificationLevel || {});\n\n// src/bridge.ts\n\n\n// src/lib/validation.ts\nfunction validate_bridge_url(bridge_url, is_staging) {\n  try {\n    new URL(bridge_url);\n  } catch (e) {\n    return { valid: false, errors: [\"Failed to parse Bridge URL.\"] };\n  }\n  const test_url = new URL(bridge_url);\n  const errors = [];\n  if (is_staging && [\"localhost\", \"127.0.0.1\"].includes(test_url.hostname)) {\n    console.log(\"Using staging app_id with localhost bridge_url. Skipping validation.\");\n    return { valid: true };\n  }\n  if (test_url.protocol !== \"https:\") {\n    errors.push(\"Bridge URL must use HTTPS.\");\n  }\n  if (test_url.port) {\n    errors.push(\"Bridge URL must use the default port (443).\");\n  }\n  if (test_url.pathname !== \"/\") {\n    errors.push(\"Bridge URL must not have a path.\");\n  }\n  if (test_url.search) {\n    errors.push(\"Bridge URL must not have query parameters.\");\n  }\n  if (test_url.hash) {\n    errors.push(\"Bridge URL must not have a fragment.\");\n  }\n  if (!test_url.hostname.endsWith(\".worldcoin.org\") && !test_url.hostname.endsWith(\".toolsforhumanity.com\")) {\n    console.warn(\n      \"Bridge URL should be a subdomain of worldcoin.org or toolsforhumanity.com. The user's identity wallet may refuse to connect. This is a temporary measure and may be removed in the future.\"\n    );\n  }\n  if (errors.length) {\n    return { valid: false, errors };\n  }\n  return { valid: true };\n}\n\n// src/lib/platform.ts\n\nvar isReactNative = () => {\n  return typeof navigator !== \"undefined\" && navigator.product === \"ReactNative\";\n};\nvar isWeb = () => {\n  return browser_or_node__WEBPACK_IMPORTED_MODULE_1__.isBrowser;\n};\nvar getGlobalObject = () => {\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  if (typeof self !== \"undefined\") return self;\n  if (typeof window !== \"undefined\") return window;\n  throw new Error(\"Unable to locate global object\");\n};\nvar getCrypto = () => {\n  const globalObj = getGlobalObject();\n  if (typeof globalObj.crypto !== \"undefined\") {\n    return globalObj.crypto;\n  }\n  throw new Error(\"Crypto API not available. For React Native, ensure polyfills are set up properly.\");\n};\n\n// src/lib/utils.ts\n\nvar DEFAULT_VERIFICATION_LEVEL = \"orb\" /* Orb */;\nvar buffer_encode = (buffer) => {\n  return buffer_index_js__WEBPACK_IMPORTED_MODULE_2__.Buffer.from(buffer).toString(\"base64\");\n};\nvar buffer_decode = (encoded) => {\n  return buffer_index_js__WEBPACK_IMPORTED_MODULE_2__.Buffer.from(encoded, \"base64\");\n};\nvar verification_level_to_credential_types = (verification_level) => {\n  switch (verification_level) {\n    case \"device\" /* Device */:\n      return [\"orb\" /* Orb */, \"device\" /* Device */];\n    case \"document\" /* Document */:\n      return [\"document\" /* Document */, \"secure_document\" /* SecureDocument */, \"orb\" /* Orb */];\n    case \"secure_document\" /* SecureDocument */:\n      return [\"secure_document\" /* SecureDocument */, \"orb\" /* Orb */];\n    case \"orb\" /* Orb */:\n      return [\"orb\" /* Orb */];\n    default:\n      throw new Error(`Unknown verification level: ${verification_level}`);\n  }\n};\nvar credential_type_to_verification_level = (credential_type) => {\n  switch (credential_type) {\n    case \"orb\" /* Orb */:\n      return \"orb\" /* Orb */;\n    case \"secure_document\" /* SecureDocument */:\n      return \"secure_document\" /* SecureDocument */;\n    case \"document\" /* Document */:\n      return \"document\" /* Document */;\n    case \"device\" /* Device */:\n      return \"device\" /* Device */;\n    default:\n      throw new Error(`Unknown credential_type: ${credential_type}`);\n  }\n};\n\n// src/lib/adapters/web-crypto-adapter.ts\nvar WebCryptoAdapter = class {\n  constructor() {\n    this.encoder = new TextEncoder();\n    this.decoder = new TextDecoder();\n  }\n  async generateKey() {\n    return {\n      iv: window.crypto.getRandomValues(new Uint8Array(12)),\n      key: await window.crypto.subtle.generateKey({ name: \"AES-GCM\", length: 256 }, true, [\"encrypt\", \"decrypt\"])\n    };\n  }\n  async exportKey(key) {\n    return buffer_encode(await window.crypto.subtle.exportKey(\"raw\", key));\n  }\n  async encryptRequest(key, iv, request) {\n    return {\n      iv: buffer_encode(iv),\n      payload: buffer_encode(\n        await window.crypto.subtle.encrypt({ name: \"AES-GCM\", iv }, key, this.encoder.encode(request))\n      )\n    };\n  }\n  async decryptResponse(key, iv, payload) {\n    return this.decoder.decode(\n      await window.crypto.subtle.decrypt({ name: \"AES-GCM\", iv }, key, buffer_decode(payload))\n    );\n  }\n};\n\n// src/lib/adapters/react-native-crypto-adapter.ts\nvar ReactNativeCryptoAdapter = class {\n  constructor() {\n    this.encoder = new TextEncoder();\n    this.decoder = new TextDecoder();\n  }\n  async generateKey() {\n    const crypto = getCrypto();\n    return {\n      iv: crypto.getRandomValues(new Uint8Array(12)),\n      key: await crypto.subtle.generateKey({ name: \"AES-GCM\", length: 256 }, true, [\"encrypt\", \"decrypt\"])\n    };\n  }\n  async exportKey(key) {\n    const crypto = getCrypto();\n    return buffer_encode(await crypto.subtle.exportKey(\"raw\", key));\n  }\n  async encryptRequest(key, iv, request) {\n    const crypto = getCrypto();\n    return {\n      iv: buffer_encode(iv),\n      payload: buffer_encode(\n        await crypto.subtle.encrypt({ name: \"AES-GCM\", iv }, key, this.encoder.encode(request))\n      )\n    };\n  }\n  async decryptResponse(key, iv, payload) {\n    const crypto = getCrypto();\n    return this.decoder.decode(await crypto.subtle.decrypt({ name: \"AES-GCM\", iv }, key, buffer_decode(payload)));\n  }\n};\n\n// src/lib/crypto.ts\nvar cryptoAdapterInstance = null;\nvar getCryptoAdapter = () => {\n  if (cryptoAdapterInstance) {\n    return cryptoAdapterInstance;\n  }\n  if (isWeb()) {\n    cryptoAdapterInstance = new WebCryptoAdapter();\n    return cryptoAdapterInstance;\n  }\n  if (isReactNative()) {\n    cryptoAdapterInstance = new ReactNativeCryptoAdapter();\n    return cryptoAdapterInstance;\n  }\n  throw new Error(\"Unsupported platform\");\n};\nvar generateKey = async () => {\n  return getCryptoAdapter().generateKey();\n};\nvar exportKey = async (key) => {\n  return getCryptoAdapter().exportKey(key);\n};\nvar encryptRequest = async (key, iv, request) => {\n  return getCryptoAdapter().encryptRequest(key, iv, request);\n};\nvar decryptResponse = async (key, iv, payload) => {\n  return getCryptoAdapter().decryptResponse(key, iv, payload);\n};\n\n// src/bridge.ts\nvar DEFAULT_BRIDGE_URL = \"https://bridge.worldcoin.org\";\nvar createStoreImplementation = (set, get) => ({\n  iv: null,\n  key: null,\n  result: null,\n  errorCode: null,\n  requestId: null,\n  connectorURI: null,\n  bridge_url: DEFAULT_BRIDGE_URL,\n  verificationState: \"loading_widget\" /* PreparingClient */,\n  createClient: async ({ bridge_url, app_id, verification_level, action_description, action, signal, partner }) => {\n    const { key, iv } = await generateKey();\n    if (bridge_url) {\n      const validation = validate_bridge_url(bridge_url, app_id.includes(\"staging\"));\n      if (!validation.valid) {\n        console.error(validation.errors.join(\"\\n\"));\n        set({ verificationState: \"failed\" /* Failed */ });\n        throw new Error(\"Invalid bridge_url. Please check the console for more details.\");\n      }\n    }\n    const res = await fetch(new URL(\"/request\", bridge_url ?? DEFAULT_BRIDGE_URL), {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(\n        await encryptRequest(\n          key,\n          iv,\n          JSON.stringify({\n            app_id,\n            action_description,\n            action: (0,_chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.encodeAction)(action),\n            signal: (0,_chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.generateSignal)(signal).digest,\n            credential_types: verification_level_to_credential_types(\n              verification_level ?? DEFAULT_VERIFICATION_LEVEL\n            ),\n            verification_level: verification_level ?? DEFAULT_VERIFICATION_LEVEL\n          })\n        )\n      )\n    });\n    if (!res.ok) {\n      set({ verificationState: \"failed\" /* Failed */ });\n      throw new Error(\"Failed to create client\");\n    }\n    const { request_id } = await res.json();\n    set({\n      iv,\n      key,\n      requestId: request_id,\n      bridge_url: bridge_url ?? DEFAULT_BRIDGE_URL,\n      verificationState: \"awaiting_connection\" /* WaitingForConnection */,\n      connectorURI: `https://world.org/verify?t=wld&i=${request_id}&k=${encodeURIComponent(\n        await exportKey(key)\n      )}${bridge_url && bridge_url !== DEFAULT_BRIDGE_URL ? `&b=${encodeURIComponent(bridge_url)}` : \"\"}${partner ? `&partner=${encodeURIComponent(true)}` : \"\"}`\n    });\n  },\n  pollForUpdates: async () => {\n    const key = get().key;\n    if (!key) throw new Error(\"No keypair found. Please call `createClient` first.\");\n    const res = await fetch(new URL(`/response/${get().requestId}`, get().bridge_url));\n    if (!res.ok) {\n      return set({\n        errorCode: \"connection_failed\" /* ConnectionFailed */,\n        verificationState: \"failed\" /* Failed */\n      });\n    }\n    const { response, status } = await res.json();\n    if (status != \"completed\" /* Completed */) {\n      return set({\n        verificationState: status == \"retrieved\" /* Retrieved */ ? \"awaiting_app\" /* WaitingForApp */ : \"awaiting_connection\" /* WaitingForConnection */\n      });\n    }\n    let result = JSON.parse(\n      await decryptResponse(key, buffer_decode(response.iv), response.payload)\n    );\n    if (\"error_code\" in result) {\n      return set({\n        errorCode: result.error_code,\n        verificationState: \"failed\" /* Failed */\n      });\n    }\n    if (\"credential_type\" in result) {\n      result = {\n        verification_level: credential_type_to_verification_level(result.credential_type),\n        ...result\n      };\n    }\n    set({\n      result,\n      key: null,\n      requestId: null,\n      connectorURI: null,\n      verificationState: \"confirmed\" /* Confirmed */\n    });\n  },\n  reset: () => {\n    set({\n      iv: null,\n      key: null,\n      result: null,\n      errorCode: null,\n      requestId: null,\n      connectorURI: null,\n      verificationState: \"loading_widget\" /* PreparingClient */\n    });\n  }\n});\nvar useWorldBridgeStore = (0,zustand__WEBPACK_IMPORTED_MODULE_3__.create)(createStoreImplementation);\nvar createWorldBridgeStore = () => (0,zustand__WEBPACK_IMPORTED_MODULE_3__.create)(createStoreImplementation);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHdvcmxkY29pbitpZGtpdC1jb3JlQDIuMS4wXzU4YzBkYzc4YTI0NmVmNGQyYzM4OTcxMTA4YzE3ZGUwL25vZGVfbW9kdWxlcy9Ad29ybGRjb2luL2lka2l0LWNvcmUvYnVpbGQvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBRzZCOztBQUU3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxxQkFBcUI7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHlCQUF5Qjs7QUFFMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNCQUFzQjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHlCQUF5Qjs7QUFFMUI7QUFDaUM7O0FBRWpDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsV0FBVztBQUNYOztBQUVBO0FBQ3FFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxzREFBUztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3lDO0FBQ3pDO0FBQ0E7QUFDQSxTQUFTLG1EQUFNO0FBQ2Y7QUFDQTtBQUNBLFNBQVMsbURBQU07QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsbUJBQW1CO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELGdCQUFnQjtBQUNsRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCw4QkFBOEI7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLHFCQUFxQjtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHFCQUFxQjtBQUNoRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsOEJBQThCO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MscUJBQXFCO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQscUJBQXFCO0FBQ2xGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixxRkFBcUY7QUFDOUcsWUFBWSxVQUFVO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYywwQ0FBMEM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixvQ0FBb0M7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZ0VBQVk7QUFDaEMsb0JBQW9CLGtFQUFjO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxZQUFZLDBDQUEwQztBQUN0RDtBQUNBO0FBQ0EsWUFBWSxhQUFhO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxXQUFXLEtBQUs7QUFDeEU7QUFDQSxRQUFRLEVBQUUsd0RBQXdELCtCQUErQixPQUFPLEVBQUUsc0JBQXNCLHlCQUF5QixPQUFPO0FBQ2hLLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsaURBQWlELGdCQUFnQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLFlBQVksbUJBQW1CO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0QsMEJBQTBCLCtDQUFNO0FBQ2hDLG1DQUFtQywrQ0FBTTtBQVV2QyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBZG1pbi5NT0hBTU1FRC1QQ1xcRG9jdW1lbnRzXFxsaWZlXFxNaW5pQXBwV2ViM3RlbXBsYXRlXFxteS1hcHBcXG5vZGVfbW9kdWxlc1xcLnBucG1cXEB3b3JsZGNvaW4raWRraXQtY29yZUAyLjEuMF81OGMwZGM3OGEyNDZlZjRkMmMzODk3MTEwOGMxN2RlMFxcbm9kZV9tb2R1bGVzXFxAd29ybGRjb2luXFxpZGtpdC1jb3JlXFxidWlsZFxcaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgZW5jb2RlQWN0aW9uLFxuICBnZW5lcmF0ZVNpZ25hbFxufSBmcm9tIFwiLi9jaHVuay1IWjJTUUE1Vi5qc1wiO1xuXG4vLyBzcmMvdHlwZXMvYnJpZGdlLnRzXG52YXIgQXBwRXJyb3JDb2RlcyA9IC8qIEBfX1BVUkVfXyAqLyAoKEFwcEVycm9yQ29kZXMyKSA9PiB7XG4gIEFwcEVycm9yQ29kZXMyW1wiQ29ubmVjdGlvbkZhaWxlZFwiXSA9IFwiY29ubmVjdGlvbl9mYWlsZWRcIjtcbiAgQXBwRXJyb3JDb2RlczJbXCJWZXJpZmljYXRpb25SZWplY3RlZFwiXSA9IFwidmVyaWZpY2F0aW9uX3JlamVjdGVkXCI7XG4gIEFwcEVycm9yQ29kZXMyW1wiTWF4VmVyaWZpY2F0aW9uc1JlYWNoZWRcIl0gPSBcIm1heF92ZXJpZmljYXRpb25zX3JlYWNoZWRcIjtcbiAgQXBwRXJyb3JDb2RlczJbXCJDcmVkZW50aWFsVW5hdmFpbGFibGVcIl0gPSBcImNyZWRlbnRpYWxfdW5hdmFpbGFibGVcIjtcbiAgQXBwRXJyb3JDb2RlczJbXCJNYWxmb3JtZWRSZXF1ZXN0XCJdID0gXCJtYWxmb3JtZWRfcmVxdWVzdFwiO1xuICBBcHBFcnJvckNvZGVzMltcIkludmFsaWROZXR3b3JrXCJdID0gXCJpbnZhbGlkX25ldHdvcmtcIjtcbiAgQXBwRXJyb3JDb2RlczJbXCJJbmNsdXNpb25Qcm9vZkZhaWxlZFwiXSA9IFwiaW5jbHVzaW9uX3Byb29mX2ZhaWxlZFwiO1xuICBBcHBFcnJvckNvZGVzMltcIkluY2x1c2lvblByb29mUGVuZGluZ1wiXSA9IFwiaW5jbHVzaW9uX3Byb29mX3BlbmRpbmdcIjtcbiAgQXBwRXJyb3JDb2RlczJbXCJVbmV4cGVjdGVkUmVzcG9uc2VcIl0gPSBcInVuZXhwZWN0ZWRfcmVzcG9uc2VcIjtcbiAgQXBwRXJyb3JDb2RlczJbXCJGYWlsZWRCeUhvc3RBcHBcIl0gPSBcImZhaWxlZF9ieV9ob3N0X2FwcFwiO1xuICBBcHBFcnJvckNvZGVzMltcIkdlbmVyaWNFcnJvclwiXSA9IFwiZ2VuZXJpY19lcnJvclwiO1xuICByZXR1cm4gQXBwRXJyb3JDb2RlczI7XG59KShBcHBFcnJvckNvZGVzIHx8IHt9KTtcbnZhciBWZXJpZmljYXRpb25TdGF0ZSA9IC8qIEBfX1BVUkVfXyAqLyAoKFZlcmlmaWNhdGlvblN0YXRlMikgPT4ge1xuICBWZXJpZmljYXRpb25TdGF0ZTJbXCJQcmVwYXJpbmdDbGllbnRcIl0gPSBcImxvYWRpbmdfd2lkZ2V0XCI7XG4gIFZlcmlmaWNhdGlvblN0YXRlMltcIldhaXRpbmdGb3JDb25uZWN0aW9uXCJdID0gXCJhd2FpdGluZ19jb25uZWN0aW9uXCI7XG4gIFZlcmlmaWNhdGlvblN0YXRlMltcIldhaXRpbmdGb3JBcHBcIl0gPSBcImF3YWl0aW5nX2FwcFwiO1xuICBWZXJpZmljYXRpb25TdGF0ZTJbXCJDb25maXJtZWRcIl0gPSBcImNvbmZpcm1lZFwiO1xuICBWZXJpZmljYXRpb25TdGF0ZTJbXCJGYWlsZWRcIl0gPSBcImZhaWxlZFwiO1xuICByZXR1cm4gVmVyaWZpY2F0aW9uU3RhdGUyO1xufSkoVmVyaWZpY2F0aW9uU3RhdGUgfHwge30pO1xuXG4vLyBzcmMvdHlwZXMvY29uZmlnLnRzXG52YXIgQ3JlZGVudGlhbFR5cGUgPSAvKiBAX19QVVJFX18gKi8gKChDcmVkZW50aWFsVHlwZTIpID0+IHtcbiAgQ3JlZGVudGlhbFR5cGUyW1wiT3JiXCJdID0gXCJvcmJcIjtcbiAgQ3JlZGVudGlhbFR5cGUyW1wiU2VjdXJlRG9jdW1lbnRcIl0gPSBcInNlY3VyZV9kb2N1bWVudFwiO1xuICBDcmVkZW50aWFsVHlwZTJbXCJEb2N1bWVudFwiXSA9IFwiZG9jdW1lbnRcIjtcbiAgQ3JlZGVudGlhbFR5cGUyW1wiRGV2aWNlXCJdID0gXCJkZXZpY2VcIjtcbiAgcmV0dXJuIENyZWRlbnRpYWxUeXBlMjtcbn0pKENyZWRlbnRpYWxUeXBlIHx8IHt9KTtcbnZhciBWZXJpZmljYXRpb25MZXZlbCA9IC8qIEBfX1BVUkVfXyAqLyAoKFZlcmlmaWNhdGlvbkxldmVsMikgPT4ge1xuICBWZXJpZmljYXRpb25MZXZlbDJbXCJPcmJcIl0gPSBcIm9yYlwiO1xuICBWZXJpZmljYXRpb25MZXZlbDJbXCJTZWN1cmVEb2N1bWVudFwiXSA9IFwic2VjdXJlX2RvY3VtZW50XCI7XG4gIFZlcmlmaWNhdGlvbkxldmVsMltcIkRvY3VtZW50XCJdID0gXCJkb2N1bWVudFwiO1xuICBWZXJpZmljYXRpb25MZXZlbDJbXCJEZXZpY2VcIl0gPSBcImRldmljZVwiO1xuICByZXR1cm4gVmVyaWZpY2F0aW9uTGV2ZWwyO1xufSkoVmVyaWZpY2F0aW9uTGV2ZWwgfHwge30pO1xuXG4vLyBzcmMvYnJpZGdlLnRzXG5pbXBvcnQgeyBjcmVhdGUgfSBmcm9tIFwienVzdGFuZFwiO1xuXG4vLyBzcmMvbGliL3ZhbGlkYXRpb24udHNcbmZ1bmN0aW9uIHZhbGlkYXRlX2JyaWRnZV91cmwoYnJpZGdlX3VybCwgaXNfc3RhZ2luZykge1xuICB0cnkge1xuICAgIG5ldyBVUkwoYnJpZGdlX3VybCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yczogW1wiRmFpbGVkIHRvIHBhcnNlIEJyaWRnZSBVUkwuXCJdIH07XG4gIH1cbiAgY29uc3QgdGVzdF91cmwgPSBuZXcgVVJMKGJyaWRnZV91cmwpO1xuICBjb25zdCBlcnJvcnMgPSBbXTtcbiAgaWYgKGlzX3N0YWdpbmcgJiYgW1wibG9jYWxob3N0XCIsIFwiMTI3LjAuMC4xXCJdLmluY2x1ZGVzKHRlc3RfdXJsLmhvc3RuYW1lKSkge1xuICAgIGNvbnNvbGUubG9nKFwiVXNpbmcgc3RhZ2luZyBhcHBfaWQgd2l0aCBsb2NhbGhvc3QgYnJpZGdlX3VybC4gU2tpcHBpbmcgdmFsaWRhdGlvbi5cIik7XG4gICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgfVxuICBpZiAodGVzdF91cmwucHJvdG9jb2wgIT09IFwiaHR0cHM6XCIpIHtcbiAgICBlcnJvcnMucHVzaChcIkJyaWRnZSBVUkwgbXVzdCB1c2UgSFRUUFMuXCIpO1xuICB9XG4gIGlmICh0ZXN0X3VybC5wb3J0KSB7XG4gICAgZXJyb3JzLnB1c2goXCJCcmlkZ2UgVVJMIG11c3QgdXNlIHRoZSBkZWZhdWx0IHBvcnQgKDQ0MykuXCIpO1xuICB9XG4gIGlmICh0ZXN0X3VybC5wYXRobmFtZSAhPT0gXCIvXCIpIHtcbiAgICBlcnJvcnMucHVzaChcIkJyaWRnZSBVUkwgbXVzdCBub3QgaGF2ZSBhIHBhdGguXCIpO1xuICB9XG4gIGlmICh0ZXN0X3VybC5zZWFyY2gpIHtcbiAgICBlcnJvcnMucHVzaChcIkJyaWRnZSBVUkwgbXVzdCBub3QgaGF2ZSBxdWVyeSBwYXJhbWV0ZXJzLlwiKTtcbiAgfVxuICBpZiAodGVzdF91cmwuaGFzaCkge1xuICAgIGVycm9ycy5wdXNoKFwiQnJpZGdlIFVSTCBtdXN0IG5vdCBoYXZlIGEgZnJhZ21lbnQuXCIpO1xuICB9XG4gIGlmICghdGVzdF91cmwuaG9zdG5hbWUuZW5kc1dpdGgoXCIud29ybGRjb2luLm9yZ1wiKSAmJiAhdGVzdF91cmwuaG9zdG5hbWUuZW5kc1dpdGgoXCIudG9vbHNmb3JodW1hbml0eS5jb21cIikpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBcIkJyaWRnZSBVUkwgc2hvdWxkIGJlIGEgc3ViZG9tYWluIG9mIHdvcmxkY29pbi5vcmcgb3IgdG9vbHNmb3JodW1hbml0eS5jb20uIFRoZSB1c2VyJ3MgaWRlbnRpdHkgd2FsbGV0IG1heSByZWZ1c2UgdG8gY29ubmVjdC4gVGhpcyBpcyBhIHRlbXBvcmFyeSBtZWFzdXJlIGFuZCBtYXkgYmUgcmVtb3ZlZCBpbiB0aGUgZnV0dXJlLlwiXG4gICAgKTtcbiAgfVxuICBpZiAoZXJyb3JzLmxlbmd0aCkge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3JzIH07XG4gIH1cbiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbn1cblxuLy8gc3JjL2xpYi9wbGF0Zm9ybS50c1xuaW1wb3J0IHsgaXNCcm93c2VyLCBpc05vZGUgYXMgaXNOb2RlQm9vbGVhbiB9IGZyb20gXCJicm93c2VyLW9yLW5vZGVcIjtcbnZhciBpc1JlYWN0TmF0aXZlID0gKCkgPT4ge1xuICByZXR1cm4gdHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJiBuYXZpZ2F0b3IucHJvZHVjdCA9PT0gXCJSZWFjdE5hdGl2ZVwiO1xufTtcbnZhciBpc1dlYiA9ICgpID0+IHtcbiAgcmV0dXJuIGlzQnJvd3Nlcjtcbn07XG52YXIgZ2V0R2xvYmFsT2JqZWN0ID0gKCkgPT4ge1xuICBpZiAodHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCIpIHJldHVybiBnbG9iYWxUaGlzO1xuICBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpIHJldHVybiBzZWxmO1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikgcmV0dXJuIHdpbmRvdztcbiAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGxvY2F0ZSBnbG9iYWwgb2JqZWN0XCIpO1xufTtcbnZhciBnZXRDcnlwdG8gPSAoKSA9PiB7XG4gIGNvbnN0IGdsb2JhbE9iaiA9IGdldEdsb2JhbE9iamVjdCgpO1xuICBpZiAodHlwZW9mIGdsb2JhbE9iai5jcnlwdG8gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gZ2xvYmFsT2JqLmNyeXB0bztcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoXCJDcnlwdG8gQVBJIG5vdCBhdmFpbGFibGUuIEZvciBSZWFjdCBOYXRpdmUsIGVuc3VyZSBwb2x5ZmlsbHMgYXJlIHNldCB1cCBwcm9wZXJseS5cIik7XG59O1xuXG4vLyBzcmMvbGliL3V0aWxzLnRzXG5pbXBvcnQgeyBCdWZmZXIgfSBmcm9tIFwiYnVmZmVyL2luZGV4LmpzXCI7XG52YXIgREVGQVVMVF9WRVJJRklDQVRJT05fTEVWRUwgPSBcIm9yYlwiIC8qIE9yYiAqLztcbnZhciBidWZmZXJfZW5jb2RlID0gKGJ1ZmZlcikgPT4ge1xuICByZXR1cm4gQnVmZmVyLmZyb20oYnVmZmVyKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbn07XG52YXIgYnVmZmVyX2RlY29kZSA9IChlbmNvZGVkKSA9PiB7XG4gIHJldHVybiBCdWZmZXIuZnJvbShlbmNvZGVkLCBcImJhc2U2NFwiKTtcbn07XG52YXIgdmVyaWZpY2F0aW9uX2xldmVsX3RvX2NyZWRlbnRpYWxfdHlwZXMgPSAodmVyaWZpY2F0aW9uX2xldmVsKSA9PiB7XG4gIHN3aXRjaCAodmVyaWZpY2F0aW9uX2xldmVsKSB7XG4gICAgY2FzZSBcImRldmljZVwiIC8qIERldmljZSAqLzpcbiAgICAgIHJldHVybiBbXCJvcmJcIiAvKiBPcmIgKi8sIFwiZGV2aWNlXCIgLyogRGV2aWNlICovXTtcbiAgICBjYXNlIFwiZG9jdW1lbnRcIiAvKiBEb2N1bWVudCAqLzpcbiAgICAgIHJldHVybiBbXCJkb2N1bWVudFwiIC8qIERvY3VtZW50ICovLCBcInNlY3VyZV9kb2N1bWVudFwiIC8qIFNlY3VyZURvY3VtZW50ICovLCBcIm9yYlwiIC8qIE9yYiAqL107XG4gICAgY2FzZSBcInNlY3VyZV9kb2N1bWVudFwiIC8qIFNlY3VyZURvY3VtZW50ICovOlxuICAgICAgcmV0dXJuIFtcInNlY3VyZV9kb2N1bWVudFwiIC8qIFNlY3VyZURvY3VtZW50ICovLCBcIm9yYlwiIC8qIE9yYiAqL107XG4gICAgY2FzZSBcIm9yYlwiIC8qIE9yYiAqLzpcbiAgICAgIHJldHVybiBbXCJvcmJcIiAvKiBPcmIgKi9dO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdmVyaWZpY2F0aW9uIGxldmVsOiAke3ZlcmlmaWNhdGlvbl9sZXZlbH1gKTtcbiAgfVxufTtcbnZhciBjcmVkZW50aWFsX3R5cGVfdG9fdmVyaWZpY2F0aW9uX2xldmVsID0gKGNyZWRlbnRpYWxfdHlwZSkgPT4ge1xuICBzd2l0Y2ggKGNyZWRlbnRpYWxfdHlwZSkge1xuICAgIGNhc2UgXCJvcmJcIiAvKiBPcmIgKi86XG4gICAgICByZXR1cm4gXCJvcmJcIiAvKiBPcmIgKi87XG4gICAgY2FzZSBcInNlY3VyZV9kb2N1bWVudFwiIC8qIFNlY3VyZURvY3VtZW50ICovOlxuICAgICAgcmV0dXJuIFwic2VjdXJlX2RvY3VtZW50XCIgLyogU2VjdXJlRG9jdW1lbnQgKi87XG4gICAgY2FzZSBcImRvY3VtZW50XCIgLyogRG9jdW1lbnQgKi86XG4gICAgICByZXR1cm4gXCJkb2N1bWVudFwiIC8qIERvY3VtZW50ICovO1xuICAgIGNhc2UgXCJkZXZpY2VcIiAvKiBEZXZpY2UgKi86XG4gICAgICByZXR1cm4gXCJkZXZpY2VcIiAvKiBEZXZpY2UgKi87XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBjcmVkZW50aWFsX3R5cGU6ICR7Y3JlZGVudGlhbF90eXBlfWApO1xuICB9XG59O1xuXG4vLyBzcmMvbGliL2FkYXB0ZXJzL3dlYi1jcnlwdG8tYWRhcHRlci50c1xudmFyIFdlYkNyeXB0b0FkYXB0ZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgIHRoaXMuZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICB9XG4gIGFzeW5jIGdlbmVyYXRlS2V5KCkge1xuICAgIHJldHVybiB7XG4gICAgICBpdjogd2luZG93LmNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTIpKSxcbiAgICAgIGtleTogYXdhaXQgd2luZG93LmNyeXB0by5zdWJ0bGUuZ2VuZXJhdGVLZXkoeyBuYW1lOiBcIkFFUy1HQ01cIiwgbGVuZ3RoOiAyNTYgfSwgdHJ1ZSwgW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIl0pXG4gICAgfTtcbiAgfVxuICBhc3luYyBleHBvcnRLZXkoa2V5KSB7XG4gICAgcmV0dXJuIGJ1ZmZlcl9lbmNvZGUoYXdhaXQgd2luZG93LmNyeXB0by5zdWJ0bGUuZXhwb3J0S2V5KFwicmF3XCIsIGtleSkpO1xuICB9XG4gIGFzeW5jIGVuY3J5cHRSZXF1ZXN0KGtleSwgaXYsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXY6IGJ1ZmZlcl9lbmNvZGUoaXYpLFxuICAgICAgcGF5bG9hZDogYnVmZmVyX2VuY29kZShcbiAgICAgICAgYXdhaXQgd2luZG93LmNyeXB0by5zdWJ0bGUuZW5jcnlwdCh7IG5hbWU6IFwiQUVTLUdDTVwiLCBpdiB9LCBrZXksIHRoaXMuZW5jb2Rlci5lbmNvZGUocmVxdWVzdCkpXG4gICAgICApXG4gICAgfTtcbiAgfVxuICBhc3luYyBkZWNyeXB0UmVzcG9uc2Uoa2V5LCBpdiwgcGF5bG9hZCkge1xuICAgIHJldHVybiB0aGlzLmRlY29kZXIuZGVjb2RlKFxuICAgICAgYXdhaXQgd2luZG93LmNyeXB0by5zdWJ0bGUuZGVjcnlwdCh7IG5hbWU6IFwiQUVTLUdDTVwiLCBpdiB9LCBrZXksIGJ1ZmZlcl9kZWNvZGUocGF5bG9hZCkpXG4gICAgKTtcbiAgfVxufTtcblxuLy8gc3JjL2xpYi9hZGFwdGVycy9yZWFjdC1uYXRpdmUtY3J5cHRvLWFkYXB0ZXIudHNcbnZhciBSZWFjdE5hdGl2ZUNyeXB0b0FkYXB0ZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgIHRoaXMuZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICB9XG4gIGFzeW5jIGdlbmVyYXRlS2V5KCkge1xuICAgIGNvbnN0IGNyeXB0byA9IGdldENyeXB0bygpO1xuICAgIHJldHVybiB7XG4gICAgICBpdjogY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxMikpLFxuICAgICAga2V5OiBhd2FpdCBjcnlwdG8uc3VidGxlLmdlbmVyYXRlS2V5KHsgbmFtZTogXCJBRVMtR0NNXCIsIGxlbmd0aDogMjU2IH0sIHRydWUsIFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCJdKVxuICAgIH07XG4gIH1cbiAgYXN5bmMgZXhwb3J0S2V5KGtleSkge1xuICAgIGNvbnN0IGNyeXB0byA9IGdldENyeXB0bygpO1xuICAgIHJldHVybiBidWZmZXJfZW5jb2RlKGF3YWl0IGNyeXB0by5zdWJ0bGUuZXhwb3J0S2V5KFwicmF3XCIsIGtleSkpO1xuICB9XG4gIGFzeW5jIGVuY3J5cHRSZXF1ZXN0KGtleSwgaXYsIHJlcXVlc3QpIHtcbiAgICBjb25zdCBjcnlwdG8gPSBnZXRDcnlwdG8oKTtcbiAgICByZXR1cm4ge1xuICAgICAgaXY6IGJ1ZmZlcl9lbmNvZGUoaXYpLFxuICAgICAgcGF5bG9hZDogYnVmZmVyX2VuY29kZShcbiAgICAgICAgYXdhaXQgY3J5cHRvLnN1YnRsZS5lbmNyeXB0KHsgbmFtZTogXCJBRVMtR0NNXCIsIGl2IH0sIGtleSwgdGhpcy5lbmNvZGVyLmVuY29kZShyZXF1ZXN0KSlcbiAgICAgIClcbiAgICB9O1xuICB9XG4gIGFzeW5jIGRlY3J5cHRSZXNwb25zZShrZXksIGl2LCBwYXlsb2FkKSB7XG4gICAgY29uc3QgY3J5cHRvID0gZ2V0Q3J5cHRvKCk7XG4gICAgcmV0dXJuIHRoaXMuZGVjb2Rlci5kZWNvZGUoYXdhaXQgY3J5cHRvLnN1YnRsZS5kZWNyeXB0KHsgbmFtZTogXCJBRVMtR0NNXCIsIGl2IH0sIGtleSwgYnVmZmVyX2RlY29kZShwYXlsb2FkKSkpO1xuICB9XG59O1xuXG4vLyBzcmMvbGliL2NyeXB0by50c1xudmFyIGNyeXB0b0FkYXB0ZXJJbnN0YW5jZSA9IG51bGw7XG52YXIgZ2V0Q3J5cHRvQWRhcHRlciA9ICgpID0+IHtcbiAgaWYgKGNyeXB0b0FkYXB0ZXJJbnN0YW5jZSkge1xuICAgIHJldHVybiBjcnlwdG9BZGFwdGVySW5zdGFuY2U7XG4gIH1cbiAgaWYgKGlzV2ViKCkpIHtcbiAgICBjcnlwdG9BZGFwdGVySW5zdGFuY2UgPSBuZXcgV2ViQ3J5cHRvQWRhcHRlcigpO1xuICAgIHJldHVybiBjcnlwdG9BZGFwdGVySW5zdGFuY2U7XG4gIH1cbiAgaWYgKGlzUmVhY3ROYXRpdmUoKSkge1xuICAgIGNyeXB0b0FkYXB0ZXJJbnN0YW5jZSA9IG5ldyBSZWFjdE5hdGl2ZUNyeXB0b0FkYXB0ZXIoKTtcbiAgICByZXR1cm4gY3J5cHRvQWRhcHRlckluc3RhbmNlO1xuICB9XG4gIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIHBsYXRmb3JtXCIpO1xufTtcbnZhciBnZW5lcmF0ZUtleSA9IGFzeW5jICgpID0+IHtcbiAgcmV0dXJuIGdldENyeXB0b0FkYXB0ZXIoKS5nZW5lcmF0ZUtleSgpO1xufTtcbnZhciBleHBvcnRLZXkgPSBhc3luYyAoa2V5KSA9PiB7XG4gIHJldHVybiBnZXRDcnlwdG9BZGFwdGVyKCkuZXhwb3J0S2V5KGtleSk7XG59O1xudmFyIGVuY3J5cHRSZXF1ZXN0ID0gYXN5bmMgKGtleSwgaXYsIHJlcXVlc3QpID0+IHtcbiAgcmV0dXJuIGdldENyeXB0b0FkYXB0ZXIoKS5lbmNyeXB0UmVxdWVzdChrZXksIGl2LCByZXF1ZXN0KTtcbn07XG52YXIgZGVjcnlwdFJlc3BvbnNlID0gYXN5bmMgKGtleSwgaXYsIHBheWxvYWQpID0+IHtcbiAgcmV0dXJuIGdldENyeXB0b0FkYXB0ZXIoKS5kZWNyeXB0UmVzcG9uc2Uoa2V5LCBpdiwgcGF5bG9hZCk7XG59O1xuXG4vLyBzcmMvYnJpZGdlLnRzXG52YXIgREVGQVVMVF9CUklER0VfVVJMID0gXCJodHRwczovL2JyaWRnZS53b3JsZGNvaW4ub3JnXCI7XG52YXIgY3JlYXRlU3RvcmVJbXBsZW1lbnRhdGlvbiA9IChzZXQsIGdldCkgPT4gKHtcbiAgaXY6IG51bGwsXG4gIGtleTogbnVsbCxcbiAgcmVzdWx0OiBudWxsLFxuICBlcnJvckNvZGU6IG51bGwsXG4gIHJlcXVlc3RJZDogbnVsbCxcbiAgY29ubmVjdG9yVVJJOiBudWxsLFxuICBicmlkZ2VfdXJsOiBERUZBVUxUX0JSSURHRV9VUkwsXG4gIHZlcmlmaWNhdGlvblN0YXRlOiBcImxvYWRpbmdfd2lkZ2V0XCIgLyogUHJlcGFyaW5nQ2xpZW50ICovLFxuICBjcmVhdGVDbGllbnQ6IGFzeW5jICh7IGJyaWRnZV91cmwsIGFwcF9pZCwgdmVyaWZpY2F0aW9uX2xldmVsLCBhY3Rpb25fZGVzY3JpcHRpb24sIGFjdGlvbiwgc2lnbmFsLCBwYXJ0bmVyIH0pID0+IHtcbiAgICBjb25zdCB7IGtleSwgaXYgfSA9IGF3YWl0IGdlbmVyYXRlS2V5KCk7XG4gICAgaWYgKGJyaWRnZV91cmwpIHtcbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZV9icmlkZ2VfdXJsKGJyaWRnZV91cmwsIGFwcF9pZC5pbmNsdWRlcyhcInN0YWdpbmdcIikpO1xuICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IodmFsaWRhdGlvbi5lcnJvcnMuam9pbihcIlxcblwiKSk7XG4gICAgICAgIHNldCh7IHZlcmlmaWNhdGlvblN0YXRlOiBcImZhaWxlZFwiIC8qIEZhaWxlZCAqLyB9KTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBicmlkZ2VfdXJsLiBQbGVhc2UgY2hlY2sgdGhlIGNvbnNvbGUgZm9yIG1vcmUgZGV0YWlscy5cIik7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKG5ldyBVUkwoXCIvcmVxdWVzdFwiLCBicmlkZ2VfdXJsID8/IERFRkFVTFRfQlJJREdFX1VSTCksIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgYXdhaXQgZW5jcnlwdFJlcXVlc3QoXG4gICAgICAgICAga2V5LFxuICAgICAgICAgIGl2LFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGFwcF9pZCxcbiAgICAgICAgICAgIGFjdGlvbl9kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGFjdGlvbjogZW5jb2RlQWN0aW9uKGFjdGlvbiksXG4gICAgICAgICAgICBzaWduYWw6IGdlbmVyYXRlU2lnbmFsKHNpZ25hbCkuZGlnZXN0LFxuICAgICAgICAgICAgY3JlZGVudGlhbF90eXBlczogdmVyaWZpY2F0aW9uX2xldmVsX3RvX2NyZWRlbnRpYWxfdHlwZXMoXG4gICAgICAgICAgICAgIHZlcmlmaWNhdGlvbl9sZXZlbCA/PyBERUZBVUxUX1ZFUklGSUNBVElPTl9MRVZFTFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvbl9sZXZlbDogdmVyaWZpY2F0aW9uX2xldmVsID8/IERFRkFVTFRfVkVSSUZJQ0FUSU9OX0xFVkVMXG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgKVxuICAgIH0pO1xuICAgIGlmICghcmVzLm9rKSB7XG4gICAgICBzZXQoeyB2ZXJpZmljYXRpb25TdGF0ZTogXCJmYWlsZWRcIiAvKiBGYWlsZWQgKi8gfSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIGNsaWVudFwiKTtcbiAgICB9XG4gICAgY29uc3QgeyByZXF1ZXN0X2lkIH0gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHNldCh7XG4gICAgICBpdixcbiAgICAgIGtleSxcbiAgICAgIHJlcXVlc3RJZDogcmVxdWVzdF9pZCxcbiAgICAgIGJyaWRnZV91cmw6IGJyaWRnZV91cmwgPz8gREVGQVVMVF9CUklER0VfVVJMLFxuICAgICAgdmVyaWZpY2F0aW9uU3RhdGU6IFwiYXdhaXRpbmdfY29ubmVjdGlvblwiIC8qIFdhaXRpbmdGb3JDb25uZWN0aW9uICovLFxuICAgICAgY29ubmVjdG9yVVJJOiBgaHR0cHM6Ly93b3JsZC5vcmcvdmVyaWZ5P3Q9d2xkJmk9JHtyZXF1ZXN0X2lkfSZrPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICBhd2FpdCBleHBvcnRLZXkoa2V5KVxuICAgICAgKX0ke2JyaWRnZV91cmwgJiYgYnJpZGdlX3VybCAhPT0gREVGQVVMVF9CUklER0VfVVJMID8gYCZiPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGJyaWRnZV91cmwpfWAgOiBcIlwifSR7cGFydG5lciA/IGAmcGFydG5lcj0ke2VuY29kZVVSSUNvbXBvbmVudCh0cnVlKX1gIDogXCJcIn1gXG4gICAgfSk7XG4gIH0sXG4gIHBvbGxGb3JVcGRhdGVzOiBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qga2V5ID0gZ2V0KCkua2V5O1xuICAgIGlmICgha2V5KSB0aHJvdyBuZXcgRXJyb3IoXCJObyBrZXlwYWlyIGZvdW5kLiBQbGVhc2UgY2FsbCBgY3JlYXRlQ2xpZW50YCBmaXJzdC5cIik7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2gobmV3IFVSTChgL3Jlc3BvbnNlLyR7Z2V0KCkucmVxdWVzdElkfWAsIGdldCgpLmJyaWRnZV91cmwpKTtcbiAgICBpZiAoIXJlcy5vaykge1xuICAgICAgcmV0dXJuIHNldCh7XG4gICAgICAgIGVycm9yQ29kZTogXCJjb25uZWN0aW9uX2ZhaWxlZFwiIC8qIENvbm5lY3Rpb25GYWlsZWQgKi8sXG4gICAgICAgIHZlcmlmaWNhdGlvblN0YXRlOiBcImZhaWxlZFwiIC8qIEZhaWxlZCAqL1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgcmVzcG9uc2UsIHN0YXR1cyB9ID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICBpZiAoc3RhdHVzICE9IFwiY29tcGxldGVkXCIgLyogQ29tcGxldGVkICovKSB7XG4gICAgICByZXR1cm4gc2V0KHtcbiAgICAgICAgdmVyaWZpY2F0aW9uU3RhdGU6IHN0YXR1cyA9PSBcInJldHJpZXZlZFwiIC8qIFJldHJpZXZlZCAqLyA/IFwiYXdhaXRpbmdfYXBwXCIgLyogV2FpdGluZ0ZvckFwcCAqLyA6IFwiYXdhaXRpbmdfY29ubmVjdGlvblwiIC8qIFdhaXRpbmdGb3JDb25uZWN0aW9uICovXG4gICAgICB9KTtcbiAgICB9XG4gICAgbGV0IHJlc3VsdCA9IEpTT04ucGFyc2UoXG4gICAgICBhd2FpdCBkZWNyeXB0UmVzcG9uc2Uoa2V5LCBidWZmZXJfZGVjb2RlKHJlc3BvbnNlLml2KSwgcmVzcG9uc2UucGF5bG9hZClcbiAgICApO1xuICAgIGlmIChcImVycm9yX2NvZGVcIiBpbiByZXN1bHQpIHtcbiAgICAgIHJldHVybiBzZXQoe1xuICAgICAgICBlcnJvckNvZGU6IHJlc3VsdC5lcnJvcl9jb2RlLFxuICAgICAgICB2ZXJpZmljYXRpb25TdGF0ZTogXCJmYWlsZWRcIiAvKiBGYWlsZWQgKi9cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoXCJjcmVkZW50aWFsX3R5cGVcIiBpbiByZXN1bHQpIHtcbiAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgdmVyaWZpY2F0aW9uX2xldmVsOiBjcmVkZW50aWFsX3R5cGVfdG9fdmVyaWZpY2F0aW9uX2xldmVsKHJlc3VsdC5jcmVkZW50aWFsX3R5cGUpLFxuICAgICAgICAuLi5yZXN1bHRcbiAgICAgIH07XG4gICAgfVxuICAgIHNldCh7XG4gICAgICByZXN1bHQsXG4gICAgICBrZXk6IG51bGwsXG4gICAgICByZXF1ZXN0SWQ6IG51bGwsXG4gICAgICBjb25uZWN0b3JVUkk6IG51bGwsXG4gICAgICB2ZXJpZmljYXRpb25TdGF0ZTogXCJjb25maXJtZWRcIiAvKiBDb25maXJtZWQgKi9cbiAgICB9KTtcbiAgfSxcbiAgcmVzZXQ6ICgpID0+IHtcbiAgICBzZXQoe1xuICAgICAgaXY6IG51bGwsXG4gICAgICBrZXk6IG51bGwsXG4gICAgICByZXN1bHQ6IG51bGwsXG4gICAgICBlcnJvckNvZGU6IG51bGwsXG4gICAgICByZXF1ZXN0SWQ6IG51bGwsXG4gICAgICBjb25uZWN0b3JVUkk6IG51bGwsXG4gICAgICB2ZXJpZmljYXRpb25TdGF0ZTogXCJsb2FkaW5nX3dpZGdldFwiIC8qIFByZXBhcmluZ0NsaWVudCAqL1xuICAgIH0pO1xuICB9XG59KTtcbnZhciB1c2VXb3JsZEJyaWRnZVN0b3JlID0gY3JlYXRlKGNyZWF0ZVN0b3JlSW1wbGVtZW50YXRpb24pO1xudmFyIGNyZWF0ZVdvcmxkQnJpZGdlU3RvcmUgPSAoKSA9PiBjcmVhdGUoY3JlYXRlU3RvcmVJbXBsZW1lbnRhdGlvbik7XG5leHBvcnQge1xuICBBcHBFcnJvckNvZGVzLFxuICBDcmVkZW50aWFsVHlwZSxcbiAgREVGQVVMVF9WRVJJRklDQVRJT05fTEVWRUwsXG4gIFZlcmlmaWNhdGlvbkxldmVsLFxuICBWZXJpZmljYXRpb25TdGF0ZSxcbiAgY3JlYXRlV29ybGRCcmlkZ2VTdG9yZSxcbiAgdXNlV29ybGRCcmlkZ2VTdG9yZSxcbiAgdmVyaWZpY2F0aW9uX2xldmVsX3RvX2NyZWRlbnRpYWxfdHlwZXNcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/lib/backend.js":
/*!*************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/lib/backend.js ***!
  \*************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyCloudProof: () => (/* binding */ verifyCloudProof)\n/* harmony export */ });\n/* harmony import */ var _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../chunk-HZ2SQA5V.js */ \"(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/chunk-HZ2SQA5V.js\");\n/* harmony import */ var browser_or_node__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! browser-or-node */ \"(ssr)/./node_modules/.pnpm/browser-or-node@3.0.0-pre.0/node_modules/browser-or-node/dist/index.mjs\");\n\n\n// src/lib/backend.ts\n\nasync function verifyCloudProof(proof, app_id, action, signal, endpoint, headers) {\n  if (browser_or_node__WEBPACK_IMPORTED_MODULE_1__.isBrowser) {\n    throw new Error(\"verifyCloudProof can only be used in the backend.\");\n  }\n  const response = await fetch(endpoint ?? `https://developer.worldcoin.org/api/v2/verify/${app_id}`, {\n    method: \"POST\",\n    headers: {\n      ...headers ?? {},\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      ...proof,\n      action,\n      signal_hash: (0,_chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.hashToField)(signal ?? \"\").digest\n    })\n  });\n  if (response.ok) {\n    return { success: true };\n  } else {\n    return { success: false, ...await response.json() };\n  }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHdvcmxkY29pbitpZGtpdC1jb3JlQDIuMS4wXzU4YzBkYzc4YTI0NmVmNGQyYzM4OTcxMTA4YzE3ZGUwL25vZGVfbW9kdWxlcy9Ad29ybGRjb2luL2lka2l0LWNvcmUvYnVpbGQvbGliL2JhY2tlbmQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBRThCOztBQUU5QjtBQUM0QztBQUM1QztBQUNBLE1BQU0sc0RBQVM7QUFDZjtBQUNBO0FBQ0EsNEZBQTRGLE9BQU87QUFDbkc7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsK0RBQVc7QUFDOUIsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBLGFBQWE7QUFDYixJQUFJO0FBQ0osYUFBYTtBQUNiO0FBQ0E7QUFHRSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBZG1pbi5NT0hBTU1FRC1QQ1xcRG9jdW1lbnRzXFxsaWZlXFxNaW5pQXBwV2ViM3RlbXBsYXRlXFxteS1hcHBcXG5vZGVfbW9kdWxlc1xcLnBucG1cXEB3b3JsZGNvaW4raWRraXQtY29yZUAyLjEuMF81OGMwZGM3OGEyNDZlZjRkMmMzODk3MTEwOGMxN2RlMFxcbm9kZV9tb2R1bGVzXFxAd29ybGRjb2luXFxpZGtpdC1jb3JlXFxidWlsZFxcbGliXFxiYWNrZW5kLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGhhc2hUb0ZpZWxkXG59IGZyb20gXCIuLi9jaHVuay1IWjJTUUE1Vi5qc1wiO1xuXG4vLyBzcmMvbGliL2JhY2tlbmQudHNcbmltcG9ydCB7IGlzQnJvd3NlciB9IGZyb20gXCJicm93c2VyLW9yLW5vZGVcIjtcbmFzeW5jIGZ1bmN0aW9uIHZlcmlmeUNsb3VkUHJvb2YocHJvb2YsIGFwcF9pZCwgYWN0aW9uLCBzaWduYWwsIGVuZHBvaW50LCBoZWFkZXJzKSB7XG4gIGlmIChpc0Jyb3dzZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJ2ZXJpZnlDbG91ZFByb29mIGNhbiBvbmx5IGJlIHVzZWQgaW4gdGhlIGJhY2tlbmQuXCIpO1xuICB9XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQgPz8gYGh0dHBzOi8vZGV2ZWxvcGVyLndvcmxkY29pbi5vcmcvYXBpL3YyL3ZlcmlmeS8ke2FwcF9pZH1gLCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICAuLi5oZWFkZXJzID8/IHt9LFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9LFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIC4uLnByb29mLFxuICAgICAgYWN0aW9uLFxuICAgICAgc2lnbmFsX2hhc2g6IGhhc2hUb0ZpZWxkKHNpZ25hbCA/PyBcIlwiKS5kaWdlc3RcbiAgICB9KVxuICB9KTtcbiAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCAuLi5hd2FpdCByZXNwb25zZS5qc29uKCkgfTtcbiAgfVxufVxuZXhwb3J0IHtcbiAgdmVyaWZ5Q2xvdWRQcm9vZlxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/lib/backend.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/lib/hashing.js":
/*!*************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/lib/hashing.js ***!
  \*************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   encodeAction: () => (/* reexport safe */ _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.encodeAction),\n/* harmony export */   generateSignal: () => (/* reexport safe */ _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.generateSignal),\n/* harmony export */   hashToField: () => (/* reexport safe */ _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.hashToField),\n/* harmony export */   packAndEncode: () => (/* reexport safe */ _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.packAndEncode),\n/* harmony export */   solidityEncode: () => (/* reexport safe */ _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__.solidityEncode)\n/* harmony export */ });\n/* harmony import */ var _chunk_HZ2SQA5V_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../chunk-HZ2SQA5V.js */ \"(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/chunk-HZ2SQA5V.js\");\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHdvcmxkY29pbitpZGtpdC1jb3JlQDIuMS4wXzU4YzBkYzc4YTI0NmVmNGQyYzM4OTcxMTA4YzE3ZGUwL25vZGVfbW9kdWxlcy9Ad29ybGRjb2luL2lka2l0LWNvcmUvYnVpbGQvbGliL2hhc2hpbmcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBTThCO0FBTzVCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFkbWluLk1PSEFNTUVELVBDXFxEb2N1bWVudHNcXGxpZmVcXE1pbmlBcHBXZWIzdGVtcGxhdGVcXG15LWFwcFxcbm9kZV9tb2R1bGVzXFwucG5wbVxcQHdvcmxkY29pbitpZGtpdC1jb3JlQDIuMS4wXzU4YzBkYzc4YTI0NmVmNGQyYzM4OTcxMTA4YzE3ZGUwXFxub2RlX21vZHVsZXNcXEB3b3JsZGNvaW5cXGlka2l0LWNvcmVcXGJ1aWxkXFxsaWJcXGhhc2hpbmcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgZW5jb2RlQWN0aW9uLFxuICBnZW5lcmF0ZVNpZ25hbCxcbiAgaGFzaFRvRmllbGQsXG4gIHBhY2tBbmRFbmNvZGUsXG4gIHNvbGlkaXR5RW5jb2RlXG59IGZyb20gXCIuLi9jaHVuay1IWjJTUUE1Vi5qc1wiO1xuZXhwb3J0IHtcbiAgZW5jb2RlQWN0aW9uLFxuICBnZW5lcmF0ZVNpZ25hbCxcbiAgaGFzaFRvRmllbGQsXG4gIHBhY2tBbmRFbmNvZGUsXG4gIHNvbGlkaXR5RW5jb2RlXG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@worldcoin+idkit-core@2.1.0_58c0dc78a246ef4d2c38971108c17de0/node_modules/@worldcoin/idkit-core/build/lib/hashing.js\n");

/***/ })

};
;